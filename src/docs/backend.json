
{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "description": "Represents a user's profile information, linking them to a company and role.",
      "type": "object",
      "properties": {
        "displayName": {
          "type": "string",
          "description": "The user's display name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "companyId": {
          "type": "string",
          "description": "The ID of the company this user belongs to."
        },
        "role": {
          "type": "string",
          "description": "The user's role within the company (e.g., 'admin', 'member').",
          "enum": ["admin", "member"]
        }
      },
      "required": ["displayName", "email", "companyId", "role"]
    },
    "Company": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Company",
      "type": "object",
      "description": "Represents a transport company using the system. Enables multi-tenant support.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the company."
        },
        "nomeFantasia": {
          "type": "string",
          "description": "The trade name of the company."
        },
        "cnpj": {
          "type": "string",
          "description": "The company's CNPJ (optional)."
        },
        "logoUrl": {
          "type": "string",
          "description": "URL of the company's logo image."
        },
        "cep": { "type": "string" },
        "logradouro": { "type": "string" },
        "numero": { "type": "string" },
        "bairro": { "type": "string" },
        "cidade": { "type": "string" },
        "estado": { "type": "string" },
        "msgRecebido": {
          "type": "string",
          "description": "Template for 'order received' message."
        },
        "msgEmRota": {
          "type": "string",
          "description": "Template for 'order in transit' message."
        },
        "msgEntregue": {
          "type": "string",
          "description": "Template for 'order delivered' message."
        },
        "msgChegueiCidade": {
          "type": "string",
          "description": "Template for 'we have arrived in the city' message."
        },
        "msgCobranca": {
          "type": "string",
          "description": "Template for 'pending payment reminder' message."
        },
        "codigoPrefixo": {
          "type": "string",
          "description": "Prefix for the tracking code (e.g., 'TR-')."
        },
        "linkBaseRastreio": {
          "type": "string",
          "description": "Base URL for tracking links. The tracking code will be appended to this URL.",
          "format": "uri"
        },
        "createdAt": { "type": "string", "format": "date-time" },
        "updatedAt": { "type": "string", "format": "date-time" }
      },
      "required": [
        "id",
        "nomeFantasia",
        "codigoPrefixo",
        "linkBaseRastreio"
      ]
    },
    "Order": {
      "$schema": "http://json-schema.org/draft_07/schema#",
      "title": "Order",
      "type": "object",
      "description": "Represents an order in the transport system.",
      "properties": {
        "codigoRastreio": {
          "type": "string",
          "description": "Unique tracking code for the order (e.g., TR-ABC123)."
        },
        "nomeCliente": {
          "type": "string",
          "description": "Name of the customer."
        },
        "telefone": {
          "type": "string",
          "description": "Customer's phone number (E.164 format)."
        },
        "origem": {
          "type": "string",
          "description": "Origin of the shipment."
        },
        "destino": {
          "type": "string",
          "description": "Destination of the shipment."
        },
        "valorEntrega": {
          "type": "number",
          "description": "Total delivery value, can be updated with partial payments."
        },
        "items": {
            "type": "array",
            "description": "Array of items in the order.",
            "items": {
                "type": "object",
                "properties": {
                    "description": { "type": "string" },
                    "quantity": { "type": "number" },
                    "value": { "type": "number" }
                },
                "required": ["description", "quantity", "value"]
            }
        },
        "formaPagamento": {
          "type": "string",
          "description": "Payment method (pix, dinheiro, cartao, boleto, link).",
          "enum": ["pix", "dinheiro", "cartao", "boleto", "link", "haver"]
        },
        "pago": {
          "type": "boolean",
          "description": "Indicates if the order is fully paid."
        },
        "dataPagamento": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of when the order was fully paid."
        },
        "notasPagamento": {
            "type": "string",
            "description": "Optional notes about the payment."
        },
         "payments": {
          "type": "array",
          "description": "A list of all partial or full payments made for the order.",
          "items": {
            "type": "object",
            "properties": {
              "amount": { "type": "number" },
              "method": { "type": "string" },
              "date": { "type": "string", "format": "date-time" },
              "notes": { "type": "string" }
            },
            "required": ["amount", "method", "date"]
          }
        },
        "status": {
          "type": "string",
          "description": "Order status (PENDENTE, EM_ROTA, ENTREGUE, CANCELADA).",
          "enum": ["PENDENTE", "EM_ROTA", "ENTREGUE", "CANCELADA"]
        },
        "motoristaId": {
          "type": "string",
          "description": "Reference to Driver. (Relationship: Driver 1:N Order) (Optional)",
          "format": "uuid"
        },
        "observacao": {
          "type": "string",
          "description": "Optional notes about the order."
        },
        "numeroNota": {
            "type": "string",
            "description": "The invoice number for the manifest."
        },
        "timeline": {
          "type": "array",
          "description": "Array of status changes with timestamps and user references.",
          "items": {
            "type": "object",
            "properties": {
                "status": { "type": "string" },
                "at": { "type": "string", "format": "date-time" },
                "userId": { "type": "string" }
            }
          }
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the order was created.",
          "format": "date-time"
        },
        "createdBy": {
          "type": "string",
          "description": "User who created the order."
        }
      },
      "required": [
        "codigoRastreio",
        "nomeCliente",
        "telefone",
        "origem",
        "destino",
        "valorEntrega",
        "items",
        "formaPagamento",
        "pago",
        "status",
        "timeline",
        "createdAt",
        "createdBy"
      ]
    },
    "Driver": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Driver",
      "type": "object",
      "description": "Represents a driver.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the driver."
        },
        "companyId": {
          "type": "string",
          "description": "Reference to Company. (Relationship: Company 1:N Driver)"
        },
        "nome": {
          "type": "string",
          "description": "Driver's name."
        },
        "telefone": {
          "type": "string",
          "description": "Driver's phone number."
        },
        "placa": {
          "type": "string",
          "description": "Vehicle license plate."
        },
        "ativo": {
          "type": "boolean",
          "description": "Indicates if the driver is active."
        }
      },
      "required": [
        "id",
        "companyId",
        "nome",
        "telefone",
        "placa",
        "ativo"
      ]
    },
    "Client": {
      "title": "Client",
      "description": "Represents a customer who places orders.",
      "type": "object",
      "properties": {
        "nome": {
          "type": "string",
          "description": "The full name of the client."
        },
        "telefone": {
          "type": "string",
          "description": "The client's phone number, preferably in E.164 format."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the client was created."
        }
      },
      "required": ["nome", "telefone", "createdAt"]
    },
    "Origin": {
      "title": "Origin",
      "description": "Represents a shipment origin point.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "A friendly name for the origin, e.g., 'Warehouse A'."
        },
        "address": {
          "type": "string",
          "description": "The full, concatenated address of the origin."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the origin was created."
        }
      },
      "required": ["name", "address", "createdAt"]
    },
    "Destino": {
      "title": "Destino",
      "description": "Represents a shipment destination point.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "A friendly name for the destination, e.g., 'Shopping Center'."
        },
        "address": {
          "type": "string",
          "description": "The full, concatenated address of the destination."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the destination was created."
        }
      },
      "required": ["name", "address", "createdAt"]
    },
    "Address": {
      "title": "Address",
      "description": "Represents a client's address.",
      "type": "object",
      "properties": {
        "label": { "type": "string", "description": "A label for the address, e.g., 'Casa', 'Trabalho'." },
        "logradouro": { "type": "string" },
        "numero": { "type": "string" },
        "bairro": { "type": "string" },
        "cidade": { "type": "string" },
        "estado": { "type": "string" },
        "cep": { "type": "string" },
        "fullAddress": { "type": "string", "description": "The complete, concatenated address string." },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["label", "logradouro", "numero", "bairro", "cidade", "estado", "cep", "fullAddress"]
    },
    "Vehicle": {
      "title": "Vehicle",
      "description": "Represents a company vehicle, such as a bus, van, or car.",
      "type": "object",
      "properties": {
        "placa": { "type": "string", "description": "License plate of the vehicle." },
        "modelo": { "type": "string", "description": "Model of the vehicle (e.g., 'Marcopolo G8')." },
        "ano": { "type": "number", "description": "Manufacturing year of the vehicle." },
        "tipo": { "type": "string", "description": "Type of vehicle.", "enum": ["Ônibus", "Van", "Carro", "Caminhão"] },
        "status": { "type": "string", "description": "Current operational status.", "enum": ["Ativo", "Inativo", "Em Manutenção"] },
        "seatLayout": {
          "type": "object",
          "description": "Defines the seat configuration for buses, using objects for rows.",
          "properties": {
            "lowerDeck": {
              "type": "object",
              "additionalProperties": {
                "type": "array",
                "items": {
                  "type": "string",
                  "nullable": true
                }
              }
            },
            "upperDeck": {
              "type": "object",
              "additionalProperties": {
                "type": "array",
                "items": {
                  "type": "string",
                  "nullable": true
                }
              }
            }
          }
        },
        "occupiedSeats": {
          "type": "array",
          "description": "List of seat IDs that are currently occupied.",
          "items": { "type": "string" }
        }
      },
      "required": ["placa", "modelo", "ano", "tipo", "status"]
    },
    "FinancialCategory": {
      "title": "Financial Category",
      "description": "Represents a category for financial entries.",
      "type": "object",
      "properties": {
        "name": { "type": "string", "description": "Name of the category (e.g., 'Receita de Passagem', 'Combustível')." },
        "type": { "type": "string", "description": "The type of the category.", "enum": ["Entrada", "Saída"] }
      },
      "required": ["name", "type"]
    },
    "FinancialEntry": {
      "title": "Financial Entry",
      "description": "Represents a single financial transaction (income or expense).",
      "type": "object",
      "properties": {
        "description": { "type": "string", "description": "A brief description of the transaction." },
        "amount": { "type": "number", "description": "Value of the transaction. Positive for income, negative for expenses." },
        "type": { "type": "string", "description": "Type of transaction.", "enum": ["Entrada", "Saída"] },
        "date": { "type": "string", "format": "date-time", "description": "Date of the transaction." },
        "travelDate": { "type": "string", "format": "date-time", "description": "Date of the trip, if applicable." },
        "categoryId": { "type": "string", "description": "Reference to the FinancialCategory." },
        "vehicleId": { "type": "string", "description": "Optional reference to a Vehicle." },
        "clientId": { "type": "string", "description": "Optional reference to a Client for income entries." },
        "clientName": { "type": "string", "description": "Denormalized client name for display." },
        "notes": { "type": "string", "description": "Additional notes." },
        "origin": { "type": "string", "description": "Origin of the trip, if applicable." },
        "destination": { "type": "string", "description": "Destination of the trip, if applicable." },
        "selectedSeats": { "type": "array", "items": { "type": "string" }, "description": "Seats selected for a ticket sale." },
        "formaPagamento": {
            "type": "string",
            "description": "Payment method used for the transaction.",
            "enum": ["pix", "dinheiro", "cartao", "boleto", "link", "haver"]
        }
      },
      "required": ["description", "amount", "type", "date", "categoryId"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/UserProfile"
      },
      "description": "Stores public information about a user, including their company affiliation."
    },
    "/companies/{companyId}": {
        "schema": {
            "$ref": "#/entities/Company"
        },
        "description": "Stores the settings and branding for a company."
    },
    "/companies/{companyId}/clients/{clientId}": {
      "schema": {
        "$ref": "#/entities/Client"
      },
      "description": "Stores customer information for a specific company."
    },
    "/companies/{companyId}/origins/{originId}": {
        "schema": {
            "$ref": "#/entities/Origin"
        },
        "description": "Stores shipment origin points for a specific company."
    },
    "/companies/{companyId}/destinos/{destinoId}": {
        "schema": {
            "$ref": "#/entities/Destino"
        },
        "description": "Stores shipment destination points for a specific company."
    },
    "/companies/{companyId}/clients/{clientId}/addresses/{addressId}": {
      "schema": {
        "$ref": "#/entities/Address"
      },
      "description": "Stores addresses for a specific client."
    },
    "/companies/{companyId}/orders/{orderId}": {
      "schema": {
        "$ref": "#/entities/Order"
      },
      "description": "Stores all orders for a specific company."
    },
     "/companies/{companyId}/drivers/{driverId}": {
      "schema": {
        "$ref": "#/entities/Driver"
      },
      "description": "Stores driver information for a specific company."
    },
    "/companies/{companyId}/vehicles/{vehicleId}": {
      "schema": { "$ref": "#/entities/Vehicle" },
      "description": "Stores company vehicles."
    },
    "/companies/{companyId}/financialCategories/{categoryId}": {
      "schema": { "$ref": "#/entities/FinancialCategory" },
      "description": "Stores categories for financial entries."
    },
    "/companies/{companyId}/financialEntries/{entryId}": {
      "schema": { "$ref": "#/entities/FinancialEntry" },
      "description": "Stores all financial transactions for a company."
    }
  }
}

    