
{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "description": "Represents a user's profile information.",
      "type": "object",
      "properties": {
        "displayName": {
          "type": "string",
          "description": "The user's display name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "companyId": { "type": "string" },
        "role": { "type": "string" }
      },
      "required": ["displayName", "email", "companyId", "role"]
    },
     "Company": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Company",
      "type": "object",
      "description": "Represents a transport company using the system. Enables multi-tenant support.",
      "properties": {
        "nomeFantasia": {
          "type": "string",
          "description": "The trade name of the company."
        },
        "cnpj": {
          "type": "string",
          "description": "The company's CNPJ (optional)."
        },
        "logoUrl": {
          "type": "string",
          "description": "URL of the company's logo image."
        },
        "cep": { "type": "string" },
        "logradouro": { "type": "string" },
        "numero": { "type": "string" },
        "bairro": { "type": "string" },
        "cidade": { "type": "string" },
        "estado": { "type": "string" },
        "msgRecebido": {
          "type": "string",
          "description": "Template for 'order received' message."
        },
        "msgEmRota": {
          "type": "string",
          "description": "Template for 'order in transit' message."
        },
        "msgEntregue": {
          "type": "string",
          "description": "Template for 'order delivered' message."
        },
        "codigoPrefixo": {
          "type": "string",
          "description": "Prefix for the tracking code (e.g., 'TR-')."
        },
        "linkBaseRastreio": {
          "type": "string",
          "description": "Base URL for tracking links. The tracking code will be appended to this URL.",
          "format": "uri"
        },
        "createdAt": { "type": "string", "format": "date-time" },
        "updatedAt": { "type": "string", "format": "date-time" }
      },
      "required": [
        "nomeFantasia",
        "codigoPrefixo",
        "linkBaseRastreio"
      ]
    },
    "Order": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Order",
      "type": "object",
      "description": "Represents an order in the transport system.",
      "properties": {
        "codigoRastreio": {
          "type": "string",
          "description": "Unique tracking code for the order (e.g., TR-ABC123)."
        },
        "nomeCliente": {
          "type": "string",
          "description": "Name of the customer."
        },
        "telefone": {
          "type": "string",
          "description": "Customer's phone number (E.164 format)."
        },
        "origem": {
          "type": "string",
          "description": "Origin of the shipment."
        },
        "destino": {
          "type": "string",
          "description": "Destination of the shipment."
        },
        "valorEntrega": {
          "type": "number",
          "description": "Total delivery value, calculated from items."
        },
        "items": {
            "type": "array",
            "description": "Array of items in the order.",
            "items": {
                "type": "object",
                "properties": {
                    "description": { "type": "string" },
                    "quantity": { "type": "number" },
                    "value": { "type": "number" }
                },
                "required": ["description", "quantity", "value"]
            }
        },
        "formaPagamento": {
          "type": "string",
          "description": "Payment method (pix, dinheiro, cartao, boleto, link).",
          "enum": ["pix", "dinheiro", "cartao", "boleto", "link", "haver"]
        },
        "pago": {
          "type": "boolean",
          "description": "Indicates if the order is paid."
        },
        "status": {
          "type": "string",
          "description": "Order status (PENDENTE, EM_ROTA, ENTREGUE, CANCELADA).",
          "enum": ["PENDENTE", "EM_ROTA", "ENTREGUE", "CANCELADA"]
        },
        "motoristaId": {
          "type": "string",
          "description": "Reference to Driver. (Relationship: Driver 1:N Order) (Optional)",
          "format": "uuid"
        },
        "observacao": {
          "type": "string",
          "description": "Optional notes about the order."
        },
        "numeroNota": {
            "type": "string",
            "description": "The invoice number for the manifest."
        },
        "timeline": {
          "type": "array",
          "description": "Array of status changes with timestamps and user references.",
          "items": {
            "type": "object",
            "properties": {
                "status": { "type": "string" },
                "at": { "type": "string", "format": "date-time" },
                "userId": { "type": "string" }
            }
          }
        },
        "messages": {
          "type": "array",
          "description": "Array of messages sent related to the order.",
          "items": {
            "type": "string"
          }
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the order was created.",
          "format": "date-time"
        },
        "createdBy": {
          "type": "string",
          "description": "User who created the order."
        }
      },
      "required": [
        "codigoRastreio",
        "nomeCliente",
        "telefone",
        "origem",
        "destino",
        "valorEntrega",
        "items",
        "formaPagamento",
        "pago",
        "status",
        "timeline",
        "messages",
        "createdAt",
        "createdBy"
      ]
    },
    "Driver": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Driver",
      "type": "object",
      "description": "Represents a driver.",
      "properties": {
        "companyId": {
          "type": "string",
          "description": "Reference to Company. (Relationship: Company 1:N Driver)"
        },
        "nome": {
          "type": "string",
          "description": "Driver's name."
        },
        "telefone": {
          "type": "string",
          "description": "Driver's phone number."
        },
        "placa": {
          "type": "string",
          "description": "Vehicle license plate."
        },
        "ativo": {
          "type": "boolean",
          "description": "Indicates if the driver is active."
        }
      },
      "required": [
        "companyId",
        "nome",
        "telefone",
        "placa",
        "ativo"
      ]
    },
    "Client": {
      "title": "Client",
      "description": "Represents a customer who places orders.",
      "type": "object",
      "properties": {
        "nome": {
          "type": "string",
          "description": "The full name of the client."
        },
        "telefone": {
          "type": "string",
          "description": "The client's phone number, preferably in E.164 format."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the client was created."
        }
      },
      "required": ["nome", "telefone", "createdAt"]
    },
    "Origin": {
      "title": "Origin",
      "description": "Represents a shipment origin point.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "A friendly name for the origin, e.g., 'Warehouse A'."
        },
        "address": {
          "type": "string",
          "description": "The full, concatenated address of the origin."
        },
        "logradouro": { "type": "string" },
        "numero": { "type": "string" },
        "bairro": { "type": "string" },
        "cidade": { "type": "string" },
        "estado": { "type": "string" },
        "cep": { "type": "string" },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the origin was created."
        }
      },
      "required": ["name", "address", "logradouro", "numero", "bairro", "cidade", "estado", "cep", "createdAt"]
    },
    "Address": {
      "title": "Address",
      "description": "Represents a client's address.",
      "type": "object",
      "properties": {
        "label": { "type": "string", "description": "A label for the address, e.g., 'Casa', 'Trabalho'." },
        "logradouro": { "type": "string" },
        "numero": { "type": "string" },
        "bairro": { "type": "string" },
        "cidade": { "type": "string" },
        "estado": { "type": "string" },
        "cep": { "type": "string" },
        "fullAddress": { "type": "string", "description": "The complete, concatenated address string." },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["label", "logradouro", "numero", "bairro", "cidade", "estado", "cep", "fullAddress"]
    },
    "AvisameCampaign": {
      "title": "Avisame Campaign",
      "description": "Represents a bulk notification campaign.",
      "type": "object",
      "properties": {
        "city": { "type": "string" },
        "messageTemplate": { "type": "string" },
        "driverId": { "type": "string" },
        "includeGeo": { "type": "boolean" },
        "scheduledAt": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["scheduled", "running", "done", "failed"] },
        "stats": {
          "type": "object",
          "properties": {
            "queued": { "type": "number" },
            "sent": { "type": "number" },
            "failed": { "type": "number" }
          }
        },
        "createdAt": { "type": "string", "format": "date-time" },
        "createdBy": { "type": "string" }
      },
      "required": ["city", "messageTemplate", "scheduledAt", "status", "createdAt", "createdBy"]
    },
    "AvisameDelivery": {
      "title": "Avisame Delivery",
      "description": "Represents a single message delivery in a campaign.",
      "type": "object",
      "properties": {
        "campaignId": { "type": "string" },
        "customerId": { "type": "string" },
        "phone": { "type": "string" },
        "status": { "type": "string", "enum": ["queued", "sent", "failed"] },
        "error": { "type": "string" },
        "sentAt": { "type": "string", "format": "date-time" }
      },
      "required": ["campaignId", "customerId", "phone", "status"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/UserProfile"
      },
      "description": "Stores public information about a user."
    },
    "/companies/{companyId}": {
        "schema": {
            "$ref": "#/entities/Company"
        },
        "description": "Stores the settings and branding for a company."
    },
    "/companies/{companyId}/clients/{clientId}": {
      "schema": {
        "$ref": "#/entities/Client"
      },
      "description": "Stores customer information for a specific company."
    },
    "/companies/{companyId}/origins/{originId}": {
        "schema": {
            "$ref": "#/entities/Origin"
        },
        "description": "Stores shipment origin points for a specific company."
    },
    "/companies/{companyId}/clients/{clientId}/addresses/{addressId}": {
      "schema": {
        "$ref": "#/entities/Address"
      },
      "description": "Stores addresses for a specific client."
    },
    "/companies/{companyId}/orders/{orderId}": {
      "schema": {
        "$ref": "#/entities/Order"
      },
      "description": "Stores all orders for a specific company."
    },
    "/companies/{companyId}/avisame_campaigns/{campaignId}": {
        "schema": {
            "$ref": "#/entities/AvisameCampaign"
        },
        "description": "Stores all Avisame campaigns for a company."
    },
    "/companies/{companyId}/avisame_deliveries/{deliveryId}": {
        "schema": {
            "$ref": "#/entities/AvisameDelivery"
        },
        "description": "Stores all individual delivery statuses for Avisame campaigns."
    }
  }
}
